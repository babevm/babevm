<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Babe VM: src/c/debugger/debugger-id.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Babe VM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('debugger-id_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">debugger-id.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="bvm_8h_source.html">../../h/bvm.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__dbgidstruct.html">_dbgidstruct</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ae7853a5921d85d90c8c1714242a5ed93"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="debugger-id_8c.html#ae7853a5921d85d90c8c1714242a5ed93">DBG_IDMAP_SIZE</a>&#160;&#160;&#160;250</td></tr>
<tr class="separator:ae7853a5921d85d90c8c1714242a5ed93"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ade605cf496e31bed66bd9aed27028950"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct__dbgidstruct.html">_dbgidstruct</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="debugger-id_8c.html#ade605cf496e31bed66bd9aed27028950">dbg_id_t</a></td></tr>
<tr class="separator:ade605cf496e31bed66bd9aed27028950"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4d8399613909035b689455c57177433e"><td class="memItemLeft" align="right" valign="top">bvm_uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="debugger-id_8c.html#a4d8399613909035b689455c57177433e">calc_hash_for_ptr</a> (void *addr, int bucket_count)</td></tr>
<tr class="separator:a4d8399613909035b689455c57177433e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e8a8273cb89ecbd094fd8ba61f6f454"><td class="memItemLeft" align="right" valign="top">bvm_int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="debugger-id_8c.html#a4e8a8273cb89ecbd094fd8ba61f6f454">bvmd_id_get_by_address</a> (void *addr)</td></tr>
<tr class="separator:a4e8a8273cb89ecbd094fd8ba61f6f454"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a499ae376ce85105848f0de499d912266"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="debugger-id_8c.html#a499ae376ce85105848f0de499d912266">bvmd_id_get_by_id</a> (bvm_int32_t id)</td></tr>
<tr class="separator:a499ae376ce85105848f0de499d912266"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68a88de95c97729aabbc507d7818e73e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="debugger-id_8c.html#a68a88de95c97729aabbc507d7818e73e">bvmd_id_init</a> ()</td></tr>
<tr class="separator:a68a88de95c97729aabbc507d7818e73e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb000c7279386312da9648b1463d99bb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="debugger-id_8c.html#aeb000c7279386312da9648b1463d99bb">bvmd_id_free</a> ()</td></tr>
<tr class="separator:aeb000c7279386312da9648b1463d99bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a563c3e4f8f27371c769c6445a160e7df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="debugger-id_8c.html#a563c3e4f8f27371c769c6445a160e7df">bvmd_id_remove_addr</a> (void *addr)</td></tr>
<tr class="separator:a563c3e4f8f27371c769c6445a160e7df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cfd9f8085ea0afc08284c8f719c48e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="debugger-id_8c.html#a0cfd9f8085ea0afc08284c8f719c48e1">bvmd_id_remove_id</a> (bvm_int32_t id)</td></tr>
<tr class="separator:a0cfd9f8085ea0afc08284c8f719c48e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e5e6f39599f916160e90c158ea97bac"><td class="memItemLeft" align="right" valign="top">bvm_int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="debugger-id_8c.html#a1e5e6f39599f916160e90c158ea97bac">bvmd_id_put</a> (void *addr)</td></tr>
<tr class="separator:a1e5e6f39599f916160e90c158ea97bac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a2a27e92ab1afb08547dd1b4007191341"><td class="memItemLeft" align="right" valign="top"><a class="el" href="debugger-id_8c.html#ade605cf496e31bed66bd9aed27028950">dbg_id_t</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="debugger-id_8c.html#a2a27e92ab1afb08547dd1b4007191341">dbg_id_map</a></td></tr>
<tr class="separator:a2a27e92ab1afb08547dd1b4007191341"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46c57bf9095b48ab5a6c8cdcfdef2630"><td class="memItemLeft" align="right" valign="top"><a class="el" href="debugger-id_8c.html#ade605cf496e31bed66bd9aed27028950">dbg_id_t</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="debugger-id_8c.html#a46c57bf9095b48ab5a6c8cdcfdef2630">dbg_addr_map</a></td></tr>
<tr class="separator:a46c57bf9095b48ab5a6c8cdcfdef2630"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>JDWP Object and address ID management.</p>
<p>When an object or clazz reference is sent from the VM to the debugger in a reply (as an ID) this is where the ID/address cross reference is maintained.</p>
<p>For speed of lookup either by address, or by ID, two arrays of entries are actually maintained, although they actually share the same entries. An entry therefore is actually always participating in two linked lists - one for the ID array, and one for the address array. Entries are always added and removed from both.</p>
<p>The garbage collector removes addresses from here as it returns memory to the heap - hence the lookup by address.</p>
<p>This addr/ID mapping is only actually valid when a debug session is active. The session startup creates the map, and the session shutdown frees it up.</p>
<dl class="section author"><dt>Author</dt><dd>Greg McCreath </dd></dl>
<dl class="section since"><dt>Since</dt><dd>0.0.10 </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ae7853a5921d85d90c8c1714242a5ed93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7853a5921d85d90c8c1714242a5ed93">&#9670;&nbsp;</a></span>DBG_IDMAP_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DBG_IDMAP_SIZE&#160;&#160;&#160;250</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of buckets in each array. </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ade605cf496e31bed66bd9aed27028950"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade605cf496e31bed66bd9aed27028950">&#9670;&nbsp;</a></span>dbg_id_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__dbgidstruct.html">_dbgidstruct</a> <a class="el" href="debugger-id_8c.html#ade605cf496e31bed66bd9aed27028950">dbg_id_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Struct to hold ID/address pairs in the each array. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aeb000c7279386312da9648b1463d99bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb000c7279386312da9648b1463d99bb">&#9670;&nbsp;</a></span>bvmd_id_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bvmd_id_free </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free the memory for the ID map arrays and cleans up. </p>

</div>
</div>
<a id="a4e8a8273cb89ecbd094fd8ba61f6f454"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e8a8273cb89ecbd094fd8ba61f6f454">&#9670;&nbsp;</a></span>bvmd_id_get_by_address()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bvm_int32_t bvmd_id_get_by_address </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieves the ID of a given address, or zero if the address is not registered.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr</td><td>a given address</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the ID of the address, or zero if not registered. </dd></dl>

</div>
</div>
<a id="a499ae376ce85105848f0de499d912266"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a499ae376ce85105848f0de499d912266">&#9670;&nbsp;</a></span>bvmd_id_get_by_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* bvmd_id_get_by_id </td>
          <td>(</td>
          <td class="paramtype">bvm_int32_t&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieves the address of a given ID, or <code>NULL</code> if the ID is not registered.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>a given ID</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the address of the ID, or <code>NULL</code> if not registered. </dd></dl>

</div>
</div>
<a id="a68a88de95c97729aabbc507d7818e73e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68a88de95c97729aabbc507d7818e73e">&#9670;&nbsp;</a></span>bvmd_id_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bvmd_id_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialises and allocates memory for the ID map. </p>

</div>
</div>
<a id="a1e5e6f39599f916160e90c158ea97bac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e5e6f39599f916160e90c158ea97bac">&#9670;&nbsp;</a></span>bvmd_id_put()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bvm_int32_t bvmd_id_put </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Puts a given address into the ID map and returns its associated ID. If the address is already registered, its existing ID is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr</td><td>a given address</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the ID of the given address. </dd></dl>

</div>
</div>
<a id="a563c3e4f8f27371c769c6445a160e7df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a563c3e4f8f27371c769c6445a160e7df">&#9670;&nbsp;</a></span>bvmd_id_remove_addr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bvmd_id_remove_addr </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Removes a given address (and its ID) from the id map.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr</td><td>a given address </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0cfd9f8085ea0afc08284c8f719c48e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cfd9f8085ea0afc08284c8f719c48e1">&#9670;&nbsp;</a></span>bvmd_id_remove_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bvmd_id_remove_id </td>
          <td>(</td>
          <td class="paramtype">bvm_int32_t&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Removes a given ID (and its address) from the ID map.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>a given ID </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4d8399613909035b689455c57177433e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d8399613909035b689455c57177433e">&#9670;&nbsp;</a></span>calc_hash_for_ptr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bvm_uint32_t calc_hash_for_ptr </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bucket_count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates a hash of the address to find the right bucket. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a46c57bf9095b48ab5a6c8cdcfdef2630"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46c57bf9095b48ab5a6c8cdcfdef2630">&#9670;&nbsp;</a></span>dbg_addr_map</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="debugger-id_8c.html#ade605cf496e31bed66bd9aed27028950">dbg_id_t</a>** dbg_addr_map</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>An array of <a class="el" href="debugger-id_8c.html#ade605cf496e31bed66bd9aed27028950">dbg_id_t</a> pointers for use as the address map. </p>

</div>
</div>
<a id="a2a27e92ab1afb08547dd1b4007191341"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a27e92ab1afb08547dd1b4007191341">&#9670;&nbsp;</a></span>dbg_id_map</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="debugger-id_8c.html#ade605cf496e31bed66bd9aed27028950">dbg_id_t</a>** dbg_id_map</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>An array of <a class="el" href="debugger-id_8c.html#ade605cf496e31bed66bd9aed27028950">dbg_id_t</a> pointers for use as the ID map. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_3b19ecf29356981f494745fbef7e56bf.html">c</a></li><li class="navelem"><a class="el" href="dir_6d3094a74f5125361c1cbd78410c720e.html">debugger</a></li><li class="navelem"><a class="el" href="debugger-id_8c.html">debugger-id.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
