<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Babe VM: src/c/object.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Babe VM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('object_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">object.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="bvm_8h_source.html">../h/bvm.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad9da4f5d65150d96d698ccde4897cd62"><td class="memItemLeft" align="right" valign="top">bvm_uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="object_8c.html#ad9da4f5d65150d96d698ccde4897cd62">bvm_calchash</a> (bvm_uint8_t *key, bvm_uint16_t len)</td></tr>
<tr class="separator:ad9da4f5d65150d96d698ccde4897cd62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b86d2509fe93ae31600c0236604ae91"><td class="memItemLeft" align="right" valign="top"><a class="el" href="clazz_8h.html#a39dbc39868649a19e787acfc19537cdc">bvm_obj_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="object_8c.html#a4b86d2509fe93ae31600c0236604ae91">bvm_object_alloc</a> (<a class="el" href="clazz_8h.html#a063dade5078d595b91c1f697d4938568">bvm_instance_clazz_t</a> *clazz)</td></tr>
<tr class="separator:a4b86d2509fe93ae31600c0236604ae91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a119cddd73d0a87d1fd8e3b3a2ebb6c85"><td class="memItemLeft" align="right" valign="top"><a class="el" href="object_8h.html#a8c3c52941c0ce19484d4845d5170a215">bvm_jarray_obj_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="object_8c.html#a119cddd73d0a87d1fd8e3b3a2ebb6c85">bvm_object_alloc_array_primitive</a> (bvm_uint32_t length, <a class="el" href="clazz_8h.html#a08a17e710757b662e4dc45b0075bf50d">bvm_jtype_t</a> type)</td></tr>
<tr class="separator:a119cddd73d0a87d1fd8e3b3a2ebb6c85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3368f02088dcd44dd42ef5669bbebb90"><td class="memItemLeft" align="right" valign="top"><a class="el" href="object_8h.html#a0bc7bf0dee90885880880485291f767e">bvm_instance_array_obj_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="object_8c.html#a3368f02088dcd44dd42ef5669bbebb90">bvm_object_alloc_array_reference</a> (bvm_uint32_t length, <a class="el" href="clazz_8h.html#aad944a281f999674be45ed9044896991">bvm_clazz_t</a> *component_clazz)</td></tr>
<tr class="separator:a3368f02088dcd44dd42ef5669bbebb90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a016e12b37863fd83d4ac2626255dddea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="object_8h.html#a0bc7bf0dee90885880880485291f767e">bvm_instance_array_obj_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="object_8c.html#a016e12b37863fd83d4ac2626255dddea">bvm_object_alloc_array_multi</a> (<a class="el" href="clazz_8h.html#a639a5612073d7507cf62e43fc7b8b9eb">bvm_array_clazz_t</a> *clazz, int dimensions, bvm_native_long_t lengths[])</td></tr>
<tr class="separator:a016e12b37863fd83d4ac2626255dddea"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a1819a5d7cb62dafaa1bbb16aeefb6372"><td class="memItemLeft" align="right" valign="top"><a class="el" href="object_8h.html#a2b4f8c559a1a0a4eeae0bdcec0077e89">bvm_throwable_obj_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="object_8c.html#a1819a5d7cb62dafaa1bbb16aeefb6372">bvm_gl_out_of_memory_err_obj</a> = NULL</td></tr>
<tr class="separator:a1819a5d7cb62dafaa1bbb16aeefb6372"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Object creation and management routines.</p>
<dl class="section author"><dt>Author</dt><dd>Greg McCreath </dd></dl>
<dl class="section since"><dt>Since</dt><dd>0.0.10 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ad9da4f5d65150d96d698ccde4897cd62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9da4f5d65150d96d698ccde4897cd62">&#9670;&nbsp;</a></span>bvm_calchash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bvm_uint32_t bvm_calchash </td>
          <td>(</td>
          <td class="paramtype">bvm_uint8_t *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bvm_uint16_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate a hash of a given range of bytes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>a pointer to an array of bytes to calculate a hash on. </td></tr>
    <tr><td class="paramname">len</td><td>the length of the array of bytes used in the hash calculation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the hash of the bytes </dd></dl>

</div>
</div>
<a id="a4b86d2509fe93ae31600c0236604ae91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b86d2509fe93ae31600c0236604ae91">&#9670;&nbsp;</a></span>bvm_object_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="clazz_8h.html#a39dbc39868649a19e787acfc19537cdc">bvm_obj_t</a>* bvm_object_alloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="clazz_8h.html#a063dade5078d595b91c1f697d4938568">bvm_instance_clazz_t</a> *&#160;</td>
          <td class="paramname"><em>clazz</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create an object reference of the given clazz. Memory is allocated for the new object and all its instance fields. All field values are zeroed.</p>
<p>The object constructor is not called - hence the name of the function is simply 'alloc' rather than 'construct'.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">clazz</td><td>the clazz of the new object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a new object. </dd></dl>

</div>
</div>
<a id="a016e12b37863fd83d4ac2626255dddea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a016e12b37863fd83d4ac2626255dddea">&#9670;&nbsp;</a></span>bvm_object_alloc_array_multi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="object_8h.html#a0bc7bf0dee90885880880485291f767e">bvm_instance_array_obj_t</a>* bvm_object_alloc_array_multi </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="clazz_8h.html#a639a5612073d7507cf62e43fc7b8b9eb">bvm_array_clazz_t</a> *&#160;</td>
          <td class="paramname"><em>clazz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dimensions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bvm_native_long_t&#160;</td>
          <td class="paramname"><em>lengths</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Recursive creation of a multi-dimensional array from the stack. Support code for <a class="el" href="exec_8h.html#afe327b654b22cb1e990540a711542efd">OPCODE_multianewarray</a>.</p>
<p>Developer notes: This one can be a little tough to get your head around. Firstly, unlike <a class="el" href="object_8c.html#a3368f02088dcd44dd42ef5669bbebb90">bvm_object_alloc_array_reference</a> and <a class="el" href="object_8c.html#a119cddd73d0a87d1fd8e3b3a2ebb6c85">bvm_object_alloc_array_primitive</a>, the clazz passed in here is the actual clazz of the multi-array to create, not the clazz of the component of the to-be-created array.</p>
<p>Secondly, the <code>dimensions</code> argument may seem superflous given that we can find the number of dimension from the class name (like, just look at the '[' char in the front) - but this is not the case. In Java, the array class (say) int[][][] = new int[2][3][] has only two dimensions according to the bytecode. So we must respect the number of dimensions given in bytecode, not the name.</p>
<p>This function will create an object of the given array type and populate its elements with instances of its component arrays. This will go down as far as the number of dimensions permit, or until the component clazz is no longer an array (then we know we have reached the innermost array).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">clazz</td><td>the <a class="el" href="clazz_8h.html#a639a5612073d7507cf62e43fc7b8b9eb">bvm_array_clazz_t</a> of the array to create </td></tr>
    <tr><td class="paramname">dimensions</td><td>the number of dimensions of the array </td></tr>
    <tr><td class="paramname">lengths</td><td>an array of integer lengths - one for each array dimension</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a instance object array populated with sub-arrays. </dd></dl>

</div>
</div>
<a id="a119cddd73d0a87d1fd8e3b3a2ebb6c85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a119cddd73d0a87d1fd8e3b3a2ebb6c85">&#9670;&nbsp;</a></span>bvm_object_alloc_array_primitive()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="object_8h.html#a8c3c52941c0ce19484d4845d5170a215">bvm_jarray_obj_t</a>* bvm_object_alloc_array_primitive </td>
          <td>(</td>
          <td class="paramtype">bvm_uint32_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="clazz_8h.html#a08a17e710757b662e4dc45b0075bf50d">bvm_jtype_t</a>&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a primitive array object of the given size and component type.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">length</td><td>the array length </td></tr>
    <tr><td class="paramname">type</td><td>the primitive type of the array</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a new array object </dd></dl>

</div>
</div>
<a id="a3368f02088dcd44dd42ef5669bbebb90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3368f02088dcd44dd42ef5669bbebb90">&#9670;&nbsp;</a></span>bvm_object_alloc_array_reference()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="object_8h.html#a0bc7bf0dee90885880880485291f767e">bvm_instance_array_obj_t</a>* bvm_object_alloc_array_reference </td>
          <td>(</td>
          <td class="paramtype">bvm_uint32_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="clazz_8h.html#aad944a281f999674be45ed9044896991">bvm_clazz_t</a> *&#160;</td>
          <td class="paramname"><em>component_clazz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create an object array given a length and reference component type.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">length</td><td>the length of the new array </td></tr>
    <tr><td class="paramname">component_clazz</td><td>the component type <a class="el" href="clazz_8h.html#aad944a281f999674be45ed9044896991">bvm_clazz_t</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a new array object </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a1819a5d7cb62dafaa1bbb16aeefb6372"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1819a5d7cb62dafaa1bbb16aeefb6372">&#9670;&nbsp;</a></span>bvm_gl_out_of_memory_err_obj</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="object_8h.html#a2b4f8c559a1a0a4eeae0bdcec0077e89">bvm_throwable_obj_t</a>* bvm_gl_out_of_memory_err_obj = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handle to a pre-built out-of-memory exception object. Gets its value during VM initialisation. We do not create it during memory allocation - difficult to create an "out of memory" object when there is no memory! </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_3b19ecf29356981f494745fbef7e56bf.html">c</a></li><li class="navelem"><a class="el" href="object_8c.html">object.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
